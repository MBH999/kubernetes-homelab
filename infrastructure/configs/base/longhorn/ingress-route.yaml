---
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: longhorn-ingress
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.tls: "true"       
    traefik.ingress.kubernetes.io/router.middlewares: longhorn-system-svc-longhorn-headers@kubernetescrd
spec:
  parentRefs:
    - name: traefik-gateway
      namespace: traefik
  hostnames: ["longhorn.mbhlabs.uk"]
  rules:
    - matches:
        - path:
            type: PathPrefix
            value: /                # match everything
      backendRefs:
        - name: longhorn-frontend   # svc in longhorn-system
          port: 80
